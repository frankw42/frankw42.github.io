{"version":3,"sources":["demo/core.cljs"],"mappings":"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","names":["js/demo","js/demo.core","js/demo.core.state","demo.core/state","cljs.core.atom","demo.core/time-str","js/Date","demo.core/moveAudioControls","el","js/document","demo.core/incrmentStackIndex","cljs.core/deref","cljs.core.swap_BANG_","cljs.core/update","cljs.core/inc","cljs.core/assoc","demo.core/generate-json","img-nodes","cljs.core.array_seq","images-list","cljs.core.map_indexed","i","audio-wrapper","audio-el","audio-url","now-str","cljs.core/List","js/JSON.stringify","cljs.core/clj->js","demo.core/download-json!","filename","json-str","blob","js/Blob","url","js/URL","a","demo.core/flipBookImages?","container","num-children","demo.core/flipBookImageCount","demo.core/restore-from-json","event","js/console.log","file","reader","js/FileReader","e","data","cljs.core.js__GT_clj","js/JSON","images","trackName","artistName","image-stack","seq__105386","cljs.core/seq","chunk__105387","count__105388","i__105389","map__105392","cljs.core/--destructure-map","cljs.core.get","temp__5823__auto__","cljs.core/chunked-seq?","c__5548__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","map__105393","cljs.core/first","cljs.core/next","id","wrapper-div","img-el","G__105394","G__105395","G__105396","demo.core/play-jamendo-audio","demo.core/$","js/jQuery","demo.core/images","demo.core/tiltImages","demo.core/background-image","demo.core/show-image","image-list","idx","js/d3","cljs.core/identity","d","cljs.core._EQ_","demo.core/cycle-owl-blink-images","frame-count","interval-ms","js/setTimeout","next-frame","demo.core/cycle-owl-tilt-images","demo.core/cached-blink-images","cljs.core.mapv","img","js/Image","demo.core/cached-tilt-images","demo.core/tiltImag","demo.core/es","js/demo.core.background-imageOnce","demo.core/background-imageOnce","demo.core/Ashow-image","cljs.core.nth","demo.core/cycle-owl-images","cachedImages","step","track-name","artist-name","seq__105397","chunk__105398","count__105399","i__105400","seq__105401","chunk__105402","count__105403","i__105404","audio-wrap","play-promise","err","js/console.warn","info-el","demo.core/play-random-jamendo-track","query","client-id","audioformat","js/encodeURIComponent","js/fetch","p1__105405#","clj-data","tracks","nth-track","cljs.core/rand-int","js/alert","js/console.error","demo.core/image-choices","demo.core/music-choices","demo.core/init-jqxImageQuery","jq","cljs.core.js_invoke","args","val","demo.core/device-type","cljs.core.not_EQ_","item","demo.core/search-unsplash","_","demo.core/api-key","demo.core/init-jqxMusicQuery","demo.core/start-flipbook-animation","demo.core/cycle-flip-book","demo.core/init-jqBlinkButton","button","G__105407","js/$","cljs.core/not","js/clearTimeout","audio-element","p1__105406#","demo.core/enableEventsAllImages","node-list","cljs.core/vec","n","demo.core/hideAllImages","demo.core/init-jqTiltButton","G__105408","parent","demo.core/play-video!","video-url","video-el","demo.core/speak!","text","utterance","js/SpeechSynthesisUtterance","js/speechSynthesis","demo.core/access-key","demo.core/query","demo.core/handle-voice-change","selected-voice","demo.core/rand-int-n","js/Math.floor","js/Math.random","w","js/window.open","pageRand","res","results","first-image","image-url","cljs.core.get_in","author-name","author-link","html-content","wrapper-node-list","wrapper-vec","seq__105409","chunk__105410","count__105411","i__105412","vec__105419","vec__105422","cljs.core/vector","child","seq__105425","chunk__105426","count__105427","i__105428","vec__105430","seq__105431","first__105432","ordered","p1__105429#","cljs.core.sort_by","js/parseInt","cljs.core/>","top-img","cycled","cljs.core.concat","cljs.core/rest","cnt","seq__105433","chunk__105434","count__105435","i__105436","vec__105443","vec__105446","demo.core/toggle-info-content!","demo.core/add-info-button","js/d3.select","demo.core/download-flipbook","vec__105449","fileName","owls-list","demo.core/upload-flipbook","input","demo.core/add-upload-button","demo.core/add-download-button","demo.core/mobile-device?","ua","js/navigator","cljs.core/boolean","cljs.core/re-find","demo.core/tablet-device?","width","js/window","height","diagonal","js/Math.sqrt","demo.core/touch-device?","or__5025__auto__","demo.core/device-size","demo.core/init","file-input","audio","p1__105452#"],"sourcesContent":["\r\n(ns demo.core\r\n  (:require [cljs.core.async :refer [<!]]\r\n            [goog.object :as gobj]\r\n            [goog.dom :as gdom]\r\n            )\r\n  )\r\n;;;\r\n;;; ===  Apophenia - Patternisity - pareidolia  ===\r\n;;; ---  unintentional perception of meaning or patterns  ---\r\n;;;\r\n;;;  ;;;  Frank Wroblewski\r\n;;;  ;;;      6/12/2025\r\n;;;\r\n;;;\r\n;;; Objective:\r\n;;;   discover set of image/audio pairs that elicit likely apophenia behavior\r\n;;;     - ToDo:\r\n;;;     - Use to score people on level of apophenia.\r\n;;;     - Find min,max,adv score\r\n;;;\r\n;;;\r\n;;; --- ToDo:\r\n;;; Add way to type in new query to drop down list, save in state.\r\n;;; If device is phone scale owl container to fit screen size.\r\n;;;\r\n;;; Fix: code warnings\r\n;;;\r\n;;; --- release steps from shadow-cljs project\r\n;;;\r\n;;; project dir: PS C:\\Users\\frankw\\cljwork\\d3\\d3-png-viewer>\r\n;;;\r\n;;;  npx shadow-cljs release app\r\n;;;\r\n;;;   from directory:  output-dir = resource/public/js\r\n;;;    copy to phone: Documents/pubic/pubic:\r\n;;;           js, vendor,  *.png , index.html\r\n;;;  start webserver app on phone (Simple HTTP Server)\r\n;;;  click owl icon  (127.0.0.1:8080)\r\n;;;\r\n;;; example ipv6\r\n;;; http://[fe80::b16c:bf03:b095:cb51]:8080\r\n;;;\r\n;;;\r\n;;; --- images from unsplash:  https://api.unsplash.com/search/photos\"    ---\r\n;;; --- audio from jamendo:    https://developer.jamendo.com/v3.0   ---\r\n;;;\r\n;;; --- installed on github:\r\n;;; https://frankw42.github.io/owl/resources/public/index.html\r\n;;;\r\n;;;\r\n\r\n(defonce state (atom {:index 0 :playing? false :page 100 :blinkStart false :animation-running false}))\r\n\r\n(defn time-str []\r\n  (str (.toISOString (js/Date.))) )\r\n\r\n\r\n(defn moveAudioControls []\r\n     ;=================\r\n  (let [el (.querySelector js/document \".audio-controls-wrapper\")]\r\n    (when el\r\n      (set! (.-marginTop (.-style el)) \"-190px\")\r\n      (set! (.-opacity (.-style el)) \"0.40\")\r\n      ))\r\n  (let [el (.querySelector js/document \".track-info\")]\r\n    (when el\r\n      (set! (.-color (.-style el)) \"rgba(255, 255, 255, 0.5)\")\r\n      ))\r\n  )\r\n\r\n\r\n(defn incrmentStackIndex []\r\n  (if (:stackIndex @state)\r\n    (swap! state update :stackIndex inc)\r\n    (swap! state assoc :stackIndex 3000)\r\n    )\r\n    (moveAudioControls) ;-- if audio controls visible move up\r\n  )\r\n\r\n\r\n(defn generate-json []\r\n  (let [img-nodes (array-seq (.querySelectorAll js/document \".flipBookClass\"))\r\n        images-list (map-indexed\r\n                      (fn [i el]\r\n                        {:id  (str \"flipBook\" (+ 3000 i))\r\n                         :url (.-src el)})\r\n                      img-nodes)\r\n\r\n    ;; Find <audio> inside .audio-controls-wrapper\r\n    audio-wrapper (.querySelector js/document \".audio-controls-wrapper\")\r\n    audio-el (when audio-wrapper (.querySelector audio-wrapper \"audio\"))\r\n    audio-url (when audio-el (.-src audio-el))\r\n    now-str   (str \"OwlBuddy-\" (time-str))\r\n   ]\r\n    (list now-str\r\n      (js/JSON.stringify\r\n       (clj->js\r\n        {:name   now-str\r\n         :images images-list\r\n         :audio  audio-url\r\n         :trackName (:trackName @state)\r\n         :artistName (:artistName @state)\r\n     })))) )\r\n\r\n\r\n(defn download-json! [filename json-str]\r\n  (let [blob (js/Blob. (clj->js [json-str]) #js {:type \"application/json\"})\r\n        url (.createObjectURL js/URL blob)\r\n        a   (.createElement js/document \"a\")]\r\n    (set! (.-href a) url)\r\n    (set! (.-download a) filename)\r\n    ;; Optionally, make it invisible:\r\n    (set! (.-style.display a) \"none\")\r\n    (.appendChild (.-body js/document) a)\r\n    (.click a)\r\n    (.remove a)\r\n    (.revokeObjectURL js/URL url)))\r\n\r\n\r\n  ; (:stackIndex @state)\r\n  ; (:imageUrl @state)\r\n\r\n\r\n(defn flipBookImages? []\r\n  (let [container (.getElementById js/document \"flipBookStack\")\r\n        num-children (.-length (.-children container))]\r\n    (> num-children 0)\r\n    )\r\n  )\r\n\r\n(defn flipBookImageCount []\r\n  (let [container (.getElementById js/document \"flipBookStack\")\r\n        num-children (.-length (.-children container))]\r\n    num-children\r\n    )\r\n  )\r\n\r\n\r\n\r\n(defn restore-from-json [event]\r\n  (js/console.log \"restore:: \" event)\r\n  (let [file (aget (.-files (.-target event)) 0)]\r\n    (when file\r\n      (let [reader (js/FileReader.)]\r\n        (set! (.-onload reader)\r\n              (fn [e]\r\n                (let [json-str (.. e -target -result)\r\n                      data     (js->clj (.parse js/JSON json-str) :keywordize-keys true)\r\n                      images   (:images data)\r\n                      trackName (:trackName data)\r\n                      artistName (:artistName data)\r\n                      image-stack (.getElementById js/document \"flipBookStack\")]\r\n\r\n                  ;; --- Will merge saved images with any already loaded ---\r\n                  ;; Remove existing flipBookContainer divs\r\n                  ;; (doseq [el (array-seq (.querySelectorAll js/document \".flipBookContainer\"))]\r\n                  ;; (.remove el))\r\n                  ;;\r\n                  ;; Add images from JSON\r\n                  (doseq [{:keys [id url]} images]\r\n\r\n                    (js/console.log \"restore:: doseq: id: \" id \" url: \" url)\r\n                    (when (> (count url) 0)\r\n                      (let [wrapper-div (.createElement js/document \"div\")\r\n                            img-el (.createElement js/document \"img\")]\r\n                        ;; Set up wrapper div (same as your code)\r\n                        (set! (.-className wrapper-div) \"flipBookContainer\")\r\n                        (set! (.-id wrapper-div) (str id))\r\n                        (set! (.-style wrapper-div)\r\n                              \"width:320px; height:219px; position:absolute; overflow:hidden; display:block; background: rgba(0,0,0,0.55); color: white; margin-top:204px;\")\r\n                        (set! (.-zIndex (.-style wrapper-div)) (.substring id 8))\r\n                        ;--- for now going to use saved zIndex.  Alt: pick up from current live zIndex value.\r\n                        (incrmentStackIndex)  ; if no existing zIndex create one. Used to know when to move audio controls.\r\n                        ;; Set up image\r\n                        (set! (.-src img-el) url)\r\n                        (set! (.-className img-el) \"flipBookClass\")\r\n                        (set! (.-style img-el)\r\n                              \"max-width:100%; max-height:100%; width:auto; height:auto; display:block; margin:auto; object-fit:contain; pointer-events:none;\")\r\n                        ;; Append image to container, container to stack\r\n                        (.appendChild wrapper-div img-el)\r\n                        (.appendChild image-stack wrapper-div)))\r\n\r\n                    )\r\n\r\n                  ;; Optionally restore audio (as before)\r\n                  ;; --- if no audio saved leave any existing audio playing  ---\r\n                  ;;\r\n                  (when (:audio data)\r\n                    (play-jamendo-audio (:audio data) trackName artistName)\r\n                    (js/console.log \" images: \" images \"count: \" (count images))\r\n                    (if (flipBookImages?) (moveAudioControls))\r\n                    )\r\n                  )))\r\n        (.readAsText reader file)))))\r\n\r\n\r\n\r\n(def $ js/jQuery)\r\n\r\n(def images\r\n  [\r\n   \"images/owl/blinkClosed.png\"\r\n   \"images/owl/blinkHalf-c.png\"\r\n   \"images/owl/blinkFull-c.png\"\r\n   \"images/owl/blinkHalf-c.png\"\r\n   \"images/owl/blinkClosed.png\"\r\n   \"images/owl/blinkHalf-c.png\"\r\n   \"images/owl/blinkFull-c.png\"\r\n   \"images/owl/blinkHalf-c.png\"\r\n   \"images/owl/blinkClosed.png\"\r\n   ])\r\n\r\n(def tiltImages\r\n  [\r\n   \"images/owl/tilt/tilt1788-c.png\"\r\n   \"images/owl/tilt/tilt1789-c.png\"\r\n   \"images/owl/tilt/tilt1790-c.png\"\r\n   \"images/owl/tilt/tilt1791-c.png\"\r\n   \"images/owl/tilt/tilt1792-c.png\"\r\n   \"images/owl/tilt/tilt1793-c.png\"\r\n   \"images/owl/tilt/tilt1792-c.png\"\r\n   \"images/owl/tilt/tilt1791-c.png\"\r\n   \"images/owl/tilt/tilt1790-c.png\"\r\n   \"images/owl/tilt/tilt1789-c.png\"\r\n   \"images/owl/tilt/tilt1788-c.png\"\r\n   ])\r\n\r\n\r\n(def background-image \"images/owl/background.png\")\r\n\r\n;; UPDATED: Applied scaling (animation images to 219px for 219/320 ratio) and centering.\r\n;; - Background: Fills container width (320px), vertically centered.\r\n;; - Animation images: Scaled to 219px width, centered both vertically and horizontally.\r\n;;\r\n(defn show-image [image-list idx]\r\n     ;==========\r\n  (let [container (-> js/d3 (.select \"#owl-container\"))]\r\n    ;; Handle the background image (fills width, vertically centered)\r\n    (-> container\r\n        (.selectAll \"img.background\")\r\n        (.data #js [background-image])\r\n        (.join \"img\")\r\n        (.classed \"background\" true)\r\n        (.attr \"src\" identity)\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"top\" \"10%\")                ; NEW: For vertical centering\r\n        (.style \"left\" \"0\")                 ; Fill from left\r\n        (.style \"transform\" \"translateY(-50%)\")  ; NEW: Center vertically\r\n        (.style \"width\" \"100%\")             ; Fill container width (320px)\r\n        (.style \"height\" \"auto\")            ; Maintain aspect ratio\r\n        (.style \"z-index\" \"0\")              ; Behind animations\r\n        (.style \"display\" \"block\"))         ; Always show\r\n\r\n    ;; Handle animated images (scaled to 219px, fully centered)\r\n    (-> container\r\n        (.selectAll \"img.animated\")\r\n        (.data (clj->js image-list))\r\n        (.join \"img\")\r\n        (.classed \"animated\" true)\r\n        (.attr \"src\" identity)\r\n        (.style \"display\" (fn [d i]         ; Show only current frame\r\n                            (if (= i idx) \"block\" \"none\")))\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"top\" 0)                ; NEW: For vertical centering\r\n        (.style \"left\" \"50%\")               ; NEW: For horizontal centering\r\n        (.style \"transform\" \"translate(-50%, -100%)\")  ; NEW: Center both axes\r\n        (.style \"width\" \"219px\")            ; NEW: Scale to 219px for 219/320 ratio\r\n        (.style \"height\" \"auto\")            ; Maintain aspect ratio\r\n        (.style \"z-index\" \"1\")              ; On top of background\r\n        (.on \"click\" nil))))                ; Prevent multiple bindings\r\n\r\n\r\n(defn cycle-owl-blink-images []\r\n  (when-not (:playing? @state)\r\n    (swap! state assoc :index 0 :playing? true)\r\n    (let [frame-count (count images)\r\n          interval-ms 190]\r\n      (letfn [(next-frame [i]\r\n                (when (< i frame-count)\r\n                  (swap! state assoc :index i)\r\n                  (show-image images i)\r\n                  (js/setTimeout\r\n                    #(next-frame (inc i))\r\n                    interval-ms))\r\n                (when (= i (dec frame-count))\r\n                  (swap! state assoc :playing? false)))]\r\n        (next-frame 0)))))\r\n\r\n\r\n\r\n(defn cycle-owl-tilt-images []\r\n  (when-not (:playing? @state)\r\n    (swap! state assoc :index 0 :playing? true)\r\n    (let [frame-count (count tiltImages)\r\n          interval-ms 190]\r\n      (letfn [(next-frame [i]\r\n                (when (< i frame-count)\r\n                  (swap! state assoc :index i)\r\n                  (show-image tiltImages i)\r\n                  (js/setTimeout\r\n                    #(next-frame (inc i))\r\n                    interval-ms))\r\n                (when (= i (dec frame-count))\r\n                  (swap! state assoc :playing? false)))]\r\n        (next-frame 0)))))\r\n\r\n;;\r\n;;===============================================\r\n;;\r\n\r\n  (def cached-blink-images\r\n    (mapv (fn [filename]\r\n            (let [img (js/Image.)]\r\n              (set! (.-src img) filename)\r\n              img))\r\n          images))\r\n\r\n(def cached-tilt-images\r\n  (mapv (fn [filename]\r\n          (let [img (js/Image.)]\r\n            (set! (.-src img) filename)\r\n            img))\r\n        tiltImag\r\n        es))\r\n\r\n\r\n(defonce background-imageOnce\r\n         (let [img (js/Image.)]\r\n           (set! (.-src img) background-image)\r\n           img))\r\n\r\n\r\n(defn Ashow-image [image-list idx]\r\n  (js/console.log \"Ashow-image: \" image-list \" idx: \" idx)\r\n  (let [container (-> js/d3 (.select \"#owl-container\"))]\r\n    ;; --- Background image ---\r\n    (-> container\r\n        (.selectAll \"img.background\")\r\n        (.data #js [background-imageOnce])\r\n        (.join \"img\")\r\n        (.classed \"background\" true)\r\n        (.attr \"src\" #(.-src background-imageOnce))\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"top\" \"10%\")\r\n        (.style \"left\" \"0\")\r\n        (.style \"transform\" \"translateY(-50%)\")\r\n        (.style \"width\" \"100%\")\r\n        (.style \"height\" \"auto\")\r\n        (.style \"z-index\" \"0\")\r\n        (.style \"display\" \"block\"))\r\n\r\n    ;; --- Remove old animated frames ---\r\n    (-> container\r\n        (.selectAll \"img.animated\")\r\n        (.remove))\r\n\r\n    ;; --- Animated image (from cache) ---\r\n    (let [img-el (nth image-list idx)]\r\n\r\n\r\n      (js/console.log \"show-image:: img-el \" img-el)\r\n      (set! (.-className img-el) \"animated\")\r\n      (set! (.. img-el -style -display) \"block\")\r\n      (set! (.. img-el -style -position) \"absolute\")\r\n      (set! (.. img-el -style -top) \"0\")\r\n      (set! (.. img-el -style -left) \"50%\")\r\n      (set! (.. img-el -style -transform) \"translate(-50%, -100%)\")\r\n      (set! (.. img-el -style -width) \"219px\")\r\n      (set! (.. img-el -style -height) \"auto\")\r\n      (set! (.. img-el -style -zIndex) \"1\")\r\n      (.appendChild (.node container) img-el))))\r\n\r\n\r\n(defn cycle-owl-images [cachedImages]\r\n  (js/console.log \"cycle-owl-images\")\r\n  (let [frame-count (count cachedImages)\r\n        interval-ms 190]\r\n    (js/console.log (str \"frame count: \" frame-count))\r\n    (letfn [(step [i]\r\n              (js/console.log \" i: \" i)\r\n              (when (< i frame-count)\r\n                (Ashow-image cachedImages i)\r\n                (js/setTimeout\r\n                  #(step (inc i))\r\n                  interval-ms)))]\r\n      (step 0))))\r\n\r\n\r\n;;;\r\n;;; https://developer.jamendo.com/v3.0\r\n;;;\r\n;;;\r\n\r\n(defn play-jamendo-audio [url track-name artist-name]\r\n     ;==================\r\n  (let [container (.getElementById js/document \"owl-container\")]\r\n    (doseq [el (array-seq (.getElementsByClassName js/document \"audio-controls-wrapper\"))] (.remove el))\r\n    (doseq [el (array-seq (.getElementsByClassName js/document \"track-info\"))] (.remove el))\r\n    ;; Audio controls wrapper: add position/z-index\r\n    (let [audio-wrap (.createElement js/document \"div\")]\r\n      (set! (.-className audio-wrap) \"audio-controls-wrapper\")\r\n      (set! (.-style audio-wrap) \"width:256px; margin:12px auto 0 auto; display:block; position:relative; z-index:4016;\")\r\n      (let [audio-el (.createElement js/document \"audio\")]\r\n        (set! (.-src audio-el) url)\r\n        (set! (.-controls audio-el) true)\r\n        (set! (.-loop audio-el) true)\r\n        (set! (.-style audio-el) \"width:100%; display:block; z-index:4016;\")\r\n        (.appendChild audio-wrap audio-el)\r\n        (.appendChild container audio-wrap)\r\n        (let [play-promise (.play audio-el)]\r\n          (when play-promise\r\n            (.catch play-promise\r\n                    (fn [err]\r\n                      (js/console.warn \"Autoplay blocked; user must click play.\")))))\r\n        (let [info-el (.createElement js/document \"div\")]\r\n          (set! (.-className info-el) \"track-info\")\r\n          (set! (.-style info-el)\r\n                \"margin:7px 0 0 0; width:100%; color:#fff; font-size:13px; background:rgba(0,0,0,0.2); word-break:break-word; text-align:left; padding:3px 8px; border-radius:5px; box-sizing:border-box; position:relative; z-index:4012;\")\r\n          (set! (.-textContent info-el)\r\n                (str track-name \" \u2014 \" artist-name))\r\n          (.appendChild container info-el))))))\r\n\r\n\r\n\r\n\r\n(defn play-random-jamendo-track\r\n     ;=========================\r\n  [query client-id audioformat]\r\n  (let [url (str \"https://api.jamendo.com/v3.0/tracks/?client_id=\" client-id\r\n                 \"&format=json\"\r\n                 \"&limit=10\"\r\n                 \"&namesearch=\" (js/encodeURIComponent query)\r\n                 \"&audioformat=\" audioformat)]\r\n    (-> (js/fetch url)\r\n        (.then #(.json %))\r\n        (.then (fn [data]\r\n                 (let [clj-data (js->clj data :keywordize-keys true)\r\n                       tracks   (:results clj-data)]\r\n                   (if (seq tracks)\r\n                     (do\r\n                       (let [ nth-track (nth tracks (rand-int (count tracks)))\r\n                              audio-url (:audio nth-track)]\r\n                              (swap! state assoc :trackName (:name nth-track))\r\n                              (swap! state assoc :artistName (:artist_name nth-track))\r\n                              (js/console.log \"Playing:\" (:name nth-track) \"by\" (:artist_name nth-track))\r\n                              (play-jamendo-audio audio-url (:name nth-track) (:artist_name nth-track)))\r\n                       (if (:stackIndex @state) (moveAudioControls))\r\n                       )\r\n                     (js/alert \"No tracks found!\")))))\r\n        (.catch (fn [err]\r\n                  (js/console.error \"Jamendo API error:\" err))))))\r\n\r\n\r\n\r\n;; Valid formats: \"mp31\" \"mp32\" \"ogg\"\r\n;; (search-jamendo-tracks \"jazz\" \"0d8016e0\" \"ogg\")\r\n\r\n;;;\r\n;;;===============  end jamendo  =======================\r\n;;;\r\n\r\n\r\n\r\n(def image-choices\r\n  #js [\"Fairies\" \"Toys\" \"Puppy\" \"Ghost\" \"Apophen\"])\r\n\r\n(def music-choices\r\n  #js [\"blues\" \"rock\" \"jazz\" \"raggae\" \"Apophen\"])\r\n\r\n\r\n\r\n\r\n(defn init-jqxImageQuery []\r\n     ;==================\r\n  (let [jq ($ \"#jqxImageQuery\")]\r\n    ;; Safely initialize jqxDropDownList (works with advanced compilation)\r\n    (js-invoke jq \"jqxDropDownList\"\r\n               (clj->js {:source         image-choices\r\n                         :selectedIndex  0\r\n                         :width          \"70px\"\r\n                         :height         \"24px\"\r\n                         :dropDownHeight \"150px\"\r\n                         :theme          \"orange\"}))\r\n\r\n    ;; Handler for selecting an item\r\n    (.on jq \"select\"\r\n         (fn [e]\r\n           (let [args (.-args e)\r\n                 idx  (.-index args)\r\n                 val  (aget image-choices idx)]\r\n             (swap! state assoc :query val)\r\n             (js/console.log \"device type: \" (device-type))\r\n             (when (not= (device-type) :desktop)\r\n             (js-invoke jq \"jqxDropDownList\" \"close\"))\r\n             (js/console.log \"Image query changed:\" val))))\r\n\r\n    ;; Handler for closing the dropdown (search on select)\r\n    (.on jq \"close\"\r\n         (fn [e]\r\n           (let [item (js-invoke jq \"jqxDropDownList\" \"getSelectedItem\")\r\n                 val (.-value item)]\r\n             (when val\r\n               (js/console.log \"Selected image value via getSelectedItem:\" val)\r\n               (search-unsplash val)))))\r\n\r\n    ;; Handler for opening the dropdown: set background image\r\n    (.on jq \"open\"\r\n         (fn [_]\r\n           (set! (.. (aget jq 0) -style -backgroundImage)\r\n                 \"url('butConcave8.png')\")))\r\n\r\n    ;; Handler for closing the dropdown: set another background image\r\n    (.on jq \"close\"\r\n         (fn [_]\r\n           (set! (.. (aget jq 0) -style -backgroundImage)\r\n                 \"url('butConvex8.png')\")))))\r\n\r\n\r\n(def api-key \"50911119-a113db7cf4ad0920388f14481\")\r\n\r\n\r\n\r\n(defn init-jqxMusicQuery []\r\n     ;==================\r\n  ;; Render the music options dropdown\r\n  (let [jq ($ \"#jqxMusicQuery\")]\r\n    ;; Initialize the jqxDropDownList widget safely\r\n    (js-invoke jq \"jqxDropDownList\"\r\n               (clj->js {:source         music-choices\r\n                         :selectedIndex  0\r\n                         :width          \"70px\"\r\n                         :height         \"24px\"\r\n                         :dropDownHeight \"150px\"\r\n                         :theme          \"orange\"}))\r\n\r\n    ;; Handle \"select\" event\r\n    (.on jq \"select\"\r\n         (fn [e]\r\n           (let [args (.-args e)\r\n                 idx  (.-index args)\r\n                 val  (aget music-choices idx)]\r\n             (swap! state assoc :voice val)\r\n             (js/console.log \"device type: \" (device-type))\r\n             (when (not= (device-type) :desktop)\r\n             (js-invoke jq \"jqxDropDownList\" \"close\"))\r\n             (js/console.log \"Music option selected:\" val)\r\n             ;; Play music now only on close event\r\n             )))\r\n\r\n    ;; Handle \"close\" event\r\n    (.on jq \"close\"\r\n         (fn [e]\r\n           (let [item (js-invoke jq \"jqxDropDownList\" \"getSelectedItem\")\r\n                 val (when item (.-value item))]\r\n             (js/console.log \"Selected value via getSelectedItem:\" val)\r\n             (cycle-owl-images cached-tilt-images)\r\n             (play-random-jamendo-track val \"0d8016e0\" \"mp32\"))))\r\n\r\n    ;; Change background on open\r\n    (.on jq \"open\"\r\n         (fn [_]\r\n           (set! (.. (aget jq 0) -style -backgroundImage)\r\n                 \"url('butConcave8.png')\")))\r\n\r\n    ;; Change background on close\r\n    (.on jq \"close\"\r\n         (fn [_]\r\n           (set! (.. (aget jq 0) -style -backgroundImage)\r\n                 \"url('butConvex8.png')\")))))\r\n\r\n\r\n(defn start-flipbook-animation [] (cycle-flip-book))\r\n     ;========================\r\n\r\n\r\n(defn init-jqBlinkButton []\r\n     ;==================\r\n  (let [container (.getElementById js/document \"blink-button-container\")\r\n        button (.createElement js/document \"button\")]\r\n    (set! (.-id button) \"blink-button\")\r\n    (set! (.-innerText button) \"Blink\")\r\n\r\n    (doto (.-style button)\r\n      (set! -opacity \"0.7\")\r\n      (set! -position \"absolute\")\r\n      (set! -bottom \"0px\")\r\n      (set! -left \"10px\")\r\n      (set! -zIndex \"4020\")\r\n      (set! -backgroundColor \"orange\")  ;; this is having an effect !!!\r\n      (set! -borderRadius \"12px\")\r\n      )\r\n\r\n    (.appendChild container button)\r\n\r\n    (-> (js/$ \"#blink-button\")\r\n      ;  (.addClass \"custom-orange-button\")\r\n        (.jqxButton (clj->js {:width \"62px\" :height \"28px\" :theme \"material\"}))\r\n        (.css \"border-width\" \"0\") ; --  outer most edge\r\n        )\r\n\r\n    ;; Add click handler\r\n    (.on (js/$ \"#blink-button\") \"click\"\r\n         (fn [_]    ;--- blink button triggers owl eyes animation\r\n             (cycle-owl-blink-images)\r\n           (if (> (flipBookImageCount) 1)\r\n               (do   ;--- if less then 1 images in flipbook do not toggle & start animation ---\r\n                 (swap! state update :blinkStart not)\r\n                 (if (:blinkStart @state)\r\n                   (do\r\n                     (js/console.log \" Blink:: animation starting \")\r\n                     (swap! state assoc :animation-running true)\r\n                     ;-- set pointer-events to auto --- which enables event to delete function\r\n                     (start-flipbook-animation)\r\n                     )\r\n                   (do\r\n                     (swap! state assoc :animation-running false)\r\n                     (when (:flipTimer @state)  (js/clearTimeout (:flipTimer @state)))\r\n                     ;--- set pointer-events to none --- which enables event to info,up,down buttons\r\n                   )\r\n                 )\r\n              ;--- blink button plays Owl sound ---\r\n                   (when-let [audio-element (.getElementById js/document \"blink-sound\")]\r\n                    (-> (.play audio-element)\r\n                      ;;;  (.then #(js/alert \"\u2705 Audio played successfully ****\"))\r\n                    (.catch #(js/alert (str \"\u274c Audio play failed:\" %))))\r\n                    )\r\n              ); end do\r\n               ; if only one image flip visible / invisible\r\n               ; stop animation for one image in book\r\n               (if   (= (flipBookImageCount) 1)\r\n                 (do\r\n                   (swap! state update :blinkStart not)\r\n                   (if (:blinkStart @state)\r\n                     (do\r\n                       (js/console.log \" Blink:: show 1 image \")\r\n                       (swap! state assoc :animation-running true)\r\n                       ;; dddd  --- show single image in flipbook ---\r\n                       (enableEventsAllImages)\r\n                       (let [node-list (.querySelectorAll js/document \".flipBookContainer\")\r\n                             images (vec (array-seq node-list))\r\n                             n (count images)]\r\n                         (set! (.. (first images) -style -opacity) \"1\")\r\n                         )\r\n                       )\r\n                     (do\r\n                       (swap! state assoc :animation-running false)\r\n                       (js/console.log \" Blink:: hide one image\")\r\n                       (when (:flipTimer @state)  (js/clearTimeout (:flipTimer @state)))\r\n                       (hideAllImages)\r\n                       )\r\n                     )\r\n                 ))\r\n               )))\r\n    )\r\n  )\r\n\r\n(comment\r\n  (add-watch state :blink-watcher\r\n             (fn [key atom old-state new-state]\r\n               (when (not= (:blinkStart old-state) (:blinkStart new-state))\r\n                 (do\r\n                   (js/console.log \"blinkStart changed to:\" (:blinkStart new-state))\r\n                   (if (:blinkStart new-state)\r\n                     (animate-image-sequence)\r\n                     )\r\n                   )\r\n                 )\r\n               )\r\n             )\r\n  )\r\n\r\n\r\n(defn init-jqTiltButton []\r\n     ;=================\r\n  ;; Create a button element and append to container\r\n  (let [container (.getElementById js/document \"tilt-button-container\")\r\n        button (.createElement js/document \"button\")]\r\n    (set! (.-id button) \"tilt-button\")\r\n    (set! (.-innerText button) \"- Tilt -\")\r\n\r\n    (doto (.-style button)\r\n      (set! -opacity \"0.7\")\r\n      (set! -position \"absolute\")\r\n      (set! -bottom \"0px\")\r\n      (set! -right \"10px\")\r\n      (set! -zIndex \"4020\")\r\n      (set! -backgroundColor \"orange\")  ;; this is having an effect !!!\r\n      (set! -borderRadius \"12px\")\r\n      )\r\n    (.appendChild container button)\r\n\r\n    (-> (js/$ \"#tilt-button\")\r\n        (.jqxButton (clj->js {:width \"62px\" :height \"28px\" :theme \"material\"}))\r\n        (.css \"border-width\" \"0\") ; --  outer most edge\r\n        )\r\n\r\n    ;; Add click handler\r\n    (.on (js/$ \"#tilt-button\") \"click\"\r\n         (fn [_]\r\n           (cycle-owl-tilt-images)\r\n           (if (:imageUrl @state)\r\n             (do\r\n               ;;-- save only once --\r\n               (if (not= (:lastSavedImageUrl @state) (:imageUrl @state))\r\n                 (do\r\n                   (swap! state assoc :lastSavedImageUrl (:imageUrl @state))\r\n                   (incrmentStackIndex)\r\n\r\n                   (let [image-stack (.getElementById js/document \"flipBookStack\")\r\n                         wrapper-div (.createElement js/document \"div\")\r\n                         img-el (.createElement js/document \"img\")]\r\n                     ;; Set up wrapper div (the fixed-size container)\r\n                     (set! (.-className wrapper-div) \"flipBookContainer\")\r\n                     (set! (.-style wrapper-div)\r\n                           \"width:320px; height:219px; position:absolute; overflow:hidden; display:block; background: rgba(0,0,0,0.55); color: white; \")\r\n                     (set! (.-id wrapper-div) (str \"flipBookContainer\" (:stackIndex @state)))\r\n                     (set! (.-zIndex (.-style wrapper-div)) (str (:stackIndex @state)))\r\n                     (set! (.-marginTop (.-style wrapper-div)) \"204px\")\r\n                     ;; Set up the image\r\n                     (set! (.-src img-el) (:imageUrl @state))\r\n                     (set! (.-className img-el) \"flipBookClass\")\r\n                     (set! (.-style img-el)\r\n                           \"max-width:100%; max-height:100%; width:auto; height:auto; display:block; margin:auto; object-fit:contain; pointer-events:none;\")\r\n\r\n                     ;; when turn off animation set pointer-events to none.\r\n                     ;; when turn on  animation set pointer-events to auto.\r\n                     ;; if click on image ask for conformation to delete.\r\n                     ;; may have to temp halt animation.  DDDD\r\n\r\n                     (.addEventListener img-el \"mousedown\"\r\n                                        (fn [e]\r\n                                          (let [parent (.-parentNode (.-target e))]\r\n                                            (when parent\r\n                                              (.remove parent)))))\r\n\r\n                     ;; Add the image to the container, then container to the stack\r\n                     (.appendChild wrapper-div img-el)\r\n                     (.appendChild image-stack wrapper-div))\r\n\r\n\r\n\r\n                   (let [el (.querySelector js/document \".audio-controls-wrapper\")]\r\n                     (when el\r\n                       (set! (.-marginTop (.-style el)) \"-190px\")\r\n                       (set! (.-opacity (.-style el)) \"0.40\")\r\n                       ))\r\n\r\n                   (let [el (.querySelector js/document \".track-info\")]\r\n                     (when el\r\n                       (set! (.-color (.-style el)) \"rgba(255, 255, 255, 0.5)\")\r\n                       ))\r\n\r\n                   )\r\n                 )))\r\n           )\r\n         )))\r\n\r\n\r\n\r\n\r\n(defn play-video! [video-url]\r\n     ;===========\r\n  (let [video-el (.createElement js/document \"video\")]\r\n    (set! (.-src video-el) video-url)\r\n    (set! (.-controls video-el) true) ;; shows play/pause, etc.\r\n    (set! (.-width video-el) 480)\r\n    (.appendChild (.-body js/document) video-el)\r\n    (.play video-el)))\r\n\r\n\r\n\r\n\r\n(defn speak! [text]\r\n     ;======\r\n  (let [utterance (js/SpeechSynthesisUtterance. text)]\r\n    ;; Optional voice customization\r\n    (set! (.-lang utterance) \"en-US\")\r\n    ;; Adjust pitch, rate, and volume if desired\r\n    (set! (.-pitch utterance) 1)\r\n    (set! (.-rate utterance) 0.50)\r\n    (set! (.-volume utterance) 0.8)\r\n    ;; Speak it\r\n    (.speak js/speechSynthesis utterance)))\r\n\r\n\r\n;;; ---  Search for images in upsplash  ---\r\n;;; ---  Open in second window          ---\r\n(def access-key \"QRpZSqy6ot29xCjy6uaNmW_0MhNSFfWal8oN3ivFwHM\")\r\n(def query \"fairies\")     ; fairies  &  leprechauns\r\n\r\n\r\n\r\n(defn handle-voice-change [e]\r\n     ;===================\r\n  (let [selected-voice (.. e -target -value)]\r\n    (js/alert (str \"Voice option selected:\" selected-voice))\r\n    (swap! state assoc :voice selected-voice)\r\n    )\r\n  )\r\n\r\n(defn rand-int-n [n] (js/Math.floor (* (js/Math.random) n)))\r\n     ;==========\r\n\r\n\r\n\r\n(defn search-unsplash [query]\r\n     ;===============\r\n  (let [w (js/window.open \"\" \"_blank\" \"width=900,height=700,resizable,scrollbars\")\r\n        pageRand (js/Math.floor (* (js/Math.random) 100))\r\n        url (str \"https://api.unsplash.com/search/photos\"\r\n                 \"?query=\" (js/encodeURIComponent query)\r\n                 \"&page=\" pageRand\r\n                 \"&client_id=\" access-key)]\r\n     ;(js/console.log \" **** Window object:\" w)\r\n    (if (nil? w)\r\n      (js/alert \"Popup blocked! Please allow popups for this site.\")\r\n      (-> (js/fetch url)\r\n          (.then (fn [res] (.json res)))\r\n          (.then (fn [data]\r\n                   (let [results (js->clj (.-results data) :keywordize-keys true)\r\n                        ; first-image (first results)\r\n                         first-image (nth results (rand-int (count results)))\r\n                         image-url (get-in first-image [:urls :regular])\r\n                         author-name (get-in first-image [:user :name])\r\n                         author-link (get-in first-image [:user :links :html])\r\n                         html-content\r\n                         (str \"<html><head><title>Unsplash Image</title>\"\r\n                              \"<style>\r\n                                body { margin:0; background:#222; }\r\n                                .container { position:relative; width:100vw; height:100vh; display:flex; justify-content:center; align-items:center;}\r\n                                img { max-width:90vw; max-height:80vh; display:block; border-radius:14px; box-shadow:0 2px 18px #000a; }\r\n                                .overlay {\r\n                                  position:absolute;\r\n                                  left:24px; bottom:24px;\r\n                                  background:rgba(0,0,0,0.65);\r\n                                  color:white; font-size:22px;\r\n                                  border-radius:8px;\r\n                                  padding:10px 20px;\r\n                                  font-family:sans-serif;\r\n                                  text-shadow: 0 2px 6px #000a;\r\n                                }\r\n                                .overlay a { color:#aad; text-decoration:none;}\r\n                                .overlay a:hover { text-decoration:underline;}\r\n                              </style></head><body>\"\r\n                              \"<div class='container'>\"\r\n                              \"<img src='\" image-url \"' />\"\r\n                              \"<div class='overlay'>Photo by <a href='\" author-link \"' target='_blank'>\" author-name \"</a> on Unsplash</div>\"\r\n                              \"</div></body></html>\")]\r\n\r\n                     ;; Immediately write HTML to the new window's document\r\n                     (.write (.-document w) html-content)\r\n                     (.close (.-document w)\r\n                             (swap! state assoc :imageUrl image-url)\r\n                             ))))\r\n          (.catch (fn [err]\r\n                    (js/console.error \"Error fetching from Unsplash:\" err)))))))\r\n\r\n\r\n\r\n\r\n(defn hideAllImages []\r\n     ;=============\r\n    ; (js/alert \"hideAllImages\")\r\n  (let [wrapper-node-list (.querySelectorAll js/document \".flipBookContainer\")\r\n        wrapper-vec (vec (array-seq wrapper-node-list))]\r\n    (doseq [[i el] (map-indexed vector wrapper-vec)]\r\n      (set! (.. el -style -opacity) \"0\")\r\n      (set! (.. el -style -pointerEvents) \"none\")\r\n      ;; Set pointer-events:none for the child element (if it exists)\r\n      (when-let [child (.-firstElementChild el)]\r\n        (set! (.. child -style -pointerEvents) \"none\")))))\r\n\r\n\r\n\r\n(defn enableEventsAllImages []\r\n     ;=====================\r\n  ; (js/alert \"enableEventsAllImages\")\r\n  (let [wrapper-node-list (.querySelectorAll js/document \".flipBookContainer\")\r\n        wrapper-vec (vec (array-seq wrapper-node-list))]\r\n    (doseq [el wrapper-vec]\r\n      ;; Set pointer-events for the container if needed\r\n      (set! (.. el -style -pointerEvents) \"auto\")\r\n      ;; Set pointer-events for the single child\r\n      (let [img (.-firstElementChild el)]\r\n        (when img\r\n          (set! (.. img -style -pointerEvents) \"auto\"))))))\r\n\r\n\r\n\r\n(defn cycle-flip-book []\r\n     ;==========-----\r\n  (when (:animation-running @state)\r\n     (enableEventsAllImages)\r\n    (let [node-list (.querySelectorAll js/document \".flipBookContainer\")\r\n          images (vec (array-seq node-list))\r\n          n (count images)]\r\n      (when (> n 0)\r\n        (let [ordered (sort-by #(js/parseInt (.. % -style -zIndex)) > images)\r\n              [top-img & _] ordered]\r\n          ;; Fade out the top image\r\n          (set! (.. top-img -style -transition) \"opacity 3s\")\r\n          (set! (.-opacity (.-style top-img)) \"0\")\r\n          ;; After fade, move top to back and reassign z-indexes\r\n          (swap!  state update :flipTimer  (js/setTimeout\r\n            (fn []\r\n              (let [cycled (concat (rest ordered) [(first ordered)])\r\n                    cnt (count cycled)]\r\n                (doseq [[i el] (map-indexed vector cycled) ]\r\n                  (set! (.. el -style -zIndex) (str (+ 3000 (- cnt i 1))))\r\n                    (set! (.. el -style -opacity) \"1\")\r\n                  )\r\n                (if (:animation-running @state)\r\n                    (cycle-flip-book)\r\n                    (hideAllImages)\r\n                )\r\n              ))\r\n            3000))\r\n                  )))))\r\n\r\n\r\n\r\n\r\n(defn toggle-info-content! []\r\n     ;====================\r\n  (let [el (.getElementById js/document \"info-text\")]\r\n    (if (= (.. el -style -opacity) \"1\")\r\n      (do\r\n        (set! (.. el -style -opacity) \"0.0\")\r\n        (set! (.. el -style -backgroundColor) \"transparent\")\r\n        (set! (.. el -style -pointerEvents) \"none\")\r\n        (set! (.. js/document (getElementById \"upload-button\") -style -display) \"\")\r\n        (set! (.. js/document (getElementById \"download-button\") -style -display) \"\")\r\n        )    ;; optional: make unclickable\r\n      (do\r\n        (set! (.. js/document (getElementById \"upload-button\") -style -display) \"none\")\r\n        (set! (.. js/document (getElementById \"download-button\") -style -display) \"none\")\r\n        (set! (.. el -style -opacity) \"1\")\r\n        (set! (.. el -style -backgroundColor) \"rgba(0,0,0,0.5)\")\r\n        )\r\n      )\r\n    ;(let [[fileName owls-list] (generate-json)]\r\n    ;  (js/console.log (str \" JSON: name: \" fileName  \" owls-list: \" owls-list))\r\n    ;  (download-json! (str fileName \".json\") owls-list)\r\n    ;  )\r\n    ))\r\n\r\n\r\n(defn add-info-button []\r\n     ;===============\r\n  (let [container (.getElementById js/document \"info-button-container\")]\r\n\r\n    (-> (js/d3.select container)\r\n        (.append \"button\")\r\n        (.attr \"id\" \"info-button\")\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"right\" \"6px\")\r\n        (.style \"bottom\" \"76px\")\r\n        (.style \"width\" \"20px\")\r\n        (.style \"height\" \"20px\")\r\n        (.style \"padding\" \"0\")\r\n        (.style \"border\" \"none\")\r\n        (.style \"background\" \"none\")\r\n        (.style \"cursor\" \"pointer\")\r\n        (.style \"opacity\" \"0.7\")\r\n        (.style \"z-index\" \"4013\")\r\n        (.style \"pointer-events\" \"auto\")\r\n        (.html (str \"<img src='/images/info_orange_border.png' style='width:100%;height:100%;display:block;'/>\"))\r\n        (.on \"click\" (fn [_] (toggle-info-content!))))))\r\n\r\n\r\n(defn download-flipbook []\r\n     ;=================\r\n  (js/console.log \"****   download-flipbook \")\r\n  (let [[fileName owls-list] (generate-json)]\r\n    (js/console.log (str \" JSON: name: \" fileName  \" owls-list: \" owls-list))\r\n    (download-json! (str fileName \".json\") owls-list)\r\n    )\r\n  )\r\n\r\n\r\n(defn upload-flipbook []\r\n  ;=============\r\n  (js/console.log \"****  upload-flipbook \")\r\n  (let [input (.getElementById js/document \"json-upload\")]\r\n    (.click input)))\r\n\r\n\r\n(defn add-upload-button []\r\n    ;==================\r\n  (let [container (.getElementById js/document \"info-button-container\")]\r\n\r\n    (-> (js/d3.select container)\r\n        (.append \"button\")\r\n        (.attr \"id\" \"upload-button\")\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"right\" \"6px\")\r\n        (.style \"bottom\" \"140px\")\r\n        (.style \"width\" \"20px\")\r\n        (.style \"height\" \"20px\")\r\n        (.style \"padding\" \"0\")\r\n        (.style \"border\" \"none\")\r\n        (.style \"background\" \"none\")\r\n        (.style \"cursor\" \"pointer\")\r\n        (.style \"opacity\" \"0.7\")\r\n        (.style \"z-index\" \"4014\")\r\n        (.style \"pointer-events\" \"auto\")\r\n        (.html (str \"<img src='/images/upload.png' style='width:100%;height:100%;display:block;'/>\"))\r\n        (.on \"click\" (fn [_] (upload-flipbook))))))\r\n\r\n\r\n(defn add-download-button []\r\n     ;==================\r\n  (let [container (.getElementById js/document \"info-button-container\")]\r\n\r\n    (-> (js/d3.select container)\r\n        (.append \"button\")\r\n        (.attr \"id\" \"download-button\")\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"right\" \"6px\")\r\n        (.style \"bottom\" \"107px\")\r\n        (.style \"width\" \"20px\")\r\n        (.style \"height\" \"20px\")\r\n        (.style \"padding\" \"0\")\r\n        (.style \"border\" \"none\")\r\n        (.style \"background\" \"none\")\r\n        (.style \"cursor\" \"pointer\")\r\n        (.style \"opacity\" \"0.7\")\r\n        (.style \"z-index\" \"4014\")\r\n        (.style \"pointer-events\" \"auto\")\r\n        (.html (str \"<img src='/images/download.png' style='width:100%;height:100%;display:block;'/>\"))\r\n        (.on \"click\" (fn [_] (download-flipbook))))))\r\n\r\n\r\n\r\n;;;\r\n;;; ==========  device type  ===============\r\n;;;\r\n(defn mobile-device? []\r\n  (let [ua (.-userAgent js/navigator)]\r\n    (boolean (re-find #\"(?i)Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini\" ua))))\r\n\r\n(defn tablet-device? []\r\n  (let [width (.-innerWidth js/window)\r\n        height (.-innerHeight js/window)\r\n        diagonal (js/Math.sqrt (+ (* width width) (* height height)))]\r\n    (and (mobile-device?) (> diagonal 1000)))) ; heuristic\r\n\r\n(defn touch-device? []\r\n  (or (.-ontouchstart js/window)\r\n      (> (.-maxTouchPoints js/navigator) 0)))\r\n\r\n(defn device-type []\r\n  (cond\r\n    (tablet-device?) :tablet\r\n    (mobile-device?) :mobile\r\n    :else :desktop))\r\n\r\n\r\n(defn device-size []\r\n  (let [width (.-innerWidth js/window)\r\n        height (.-innerHeight js/window)]\r\n        (list width height)\r\n   )\r\n  )\r\n\r\n;;;\r\n;;; ======================  I N I T  =============================\r\n;;;\r\n\r\n\r\n(defn ^:export init []\r\n     ;================\r\n\r\n  (when-let [file-input (.getElementById js/document \"json-upload\")]\r\n    (.addEventListener file-input \"change\" restore-from-json))\r\n\r\n  (add-info-button)\r\n  (add-upload-button)\r\n  (add-download-button)\r\n  (show-image images 0)\r\n\r\n  ;; --- Create an invisible (hidden)( button over nose to trigger audio ---\r\n  (let [container (-> js/d3 (.select \".layer-container\"))\r\n        button (.append container \"button\")]\r\n    (-> button\r\n        (.attr \"id\" \"audioTrigger\")\r\n        (.style \"position\" \"absolute\")\r\n        (.style \"top\"  \"42%\")\r\n        (.style \"left\" \"50%\")\r\n        (.style \"transform\" \"translate(-50%, -50%)\")\r\n        (.style \"width\" \"40px\")\r\n        (.style \"height\" \"49px\")\r\n        (.style \"z-index\" \"4016\")\r\n        (.style \"background\" \"rgba(255,165,0,0.00)\")\r\n        (.style \"border\" \"none\")\r\n        (.style \"cursor\" \"pointer\")\r\n        (.style \"padding\" \"0\")\r\n        (.style \"padding-top\" \"2\")\r\n        (.style \"font-size\" \"20px\")\r\n        (.text \"\"))\r\n\r\n    ;; Add click event to play audio\r\n    (.on button \"click\"\r\n         (fn [_]\r\n           (js/console.log \"hidden button click\")\r\n\r\n           ; ;;; toDo:  Stella audio track  ????\r\n           (when-let [audio (.getElementById js/document \"blink-sound\")]\r\n            (-> (.play audio)\r\n                (.catch #(js/alert (str \"\u274c Audio play failed:\" %))))) )) )\r\n\r\n\r\n  (init-jqBlinkButton)\r\n  (init-jqTiltButton)\r\n  (init-jqxImageQuery)\r\n  (init-jqxMusicQuery)\r\n\r\n  (cycle-owl-images cached-blink-images)\r\n   (js/setTimeout (fn [] (cycle-owl-images  cached-tilt-images)) 2000)\r\n\r\n\r\n   ;=================  E N D  ==================\r\n   ;============================================\r\n  (comment\r\n    ;\r\n    ;\r\n    ; ====== for D3 app   ======\r\n    ;   in terminal window:\r\n    ; npx shadow-cljs watch app\r\n    ; ==========================\r\n    ;\r\n    ; deps.edn is a configuration file used by Clojure's dependency and\r\n    ; project management tool, tools.deps (Clojure CLI).\r\n    ;\r\n    ; shadow-cljs is a build tool for ClojureScript\r\n    ;\r\n    ; D3.js (Data-Driven Documents) is a JavaScript library\r\n    ;\r\n    ; ipconfig   get ip address of pc\r\n    ;\r\n    ; audio file:  tawnyOwlShort.mp3\r\n    ;\r\n     )\r\n\r\n  ; (js/alert (str \"Device type: \" (device-type) \" size: \"(device-size) ))\r\n;;;===============================================\r\n\r\n  ) ;end init"]}